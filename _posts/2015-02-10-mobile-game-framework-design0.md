---

layout:     post
title:      "手游框架设计&lt;零&gt;"
subtitle:   "过去一年的框架设计总结，站在巨人的肩膀上"
author:     "Fonzie"
categories: 游戏开发
tags: [心得, tag]
header-img: "img/lf2.jpg"

---

##游戏框架的作用：

我们为什么需要框架帮助开发呢？通常游戏引擎对于直接开发游戏还是有点难度的。一些常见的业务需求：UI系统开发、网络模块、数据组织、调试日志、支付登录等等都不可能在引擎层面直接适配好，这些都是常见的开发游戏中遇到的痛点。游戏框架层是直接给开发者用来开发业务的，框架的首要目标是提升开发效率，改善团队合作方式，改进工作流。以下分享比较具体的设计方案。

---

## 此架构来源
这个架构最初并非我设计，出自一位大神同事设计，他来自MSRA，曾获得ACM亚洲金牌。他架构的整体设计深具美感，而我只不过拾人牙慧。我对他的框架总结为三条原则：

1. 数据与显示分离
2. 抽象隔离变化
3. 切割过大的代码成小代码

我把他的纯C++版本改成Lua版本，并且加入了一些自己的”私货“在里面：**“单点真理，自动推导”**。改进方向以提升业务开发效率为主，这点效率的提升在人手短缺资源紧张的创业公司里，显得尤为重要。

举个例子，过去增加一条协议，需要从protobuf生成cpp，然后还要增加一些C++代码，比如定义结构体来、比如发送数据包函数等等来隔离protobuf带来的变化；而在我的版本里，protobuf不会生成代码文件，而是直接作为资源文件来加载，你只管直接用就可以了。而其他系统也类似：UI只管用就可以、数据只管取就可以，至于怎么来的，不再需要业务去写代码，而是框架层面解决了。


---

## 流畅的工作流
关于工作流以及项目管理我会在系列的最后写一篇详细分享，整个团队是怎么高效工作的，下面是个大致流程：


开发阶段：

	策划案->美术->界面开发--+
	     +-->数据表-+     |
	     +-->协议->开发功能->发布测试->debug->上线
	     
项目管理主要是采用Scrum：

* 每周负责人利用白板沟通项目进展，汇报进度
* 平时通过协作软件标记工作
* 负责人与相关同事进行紧密交流

---

## 分层架构

框架不是完全脱离业务写出来的，分层架构保证了框架不会依赖业务。事实上，框架层的代码都是来自重复的业务逻辑中抽取出来的，是来自实际代码的，所以具体框架到底有什么模块，这要看具体项目。框架层的模块我后面会单独写一篇去叙述。


![]({{ site.baseurl }}/img/framework-design/framework-design.png)
